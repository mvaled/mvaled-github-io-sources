<!DOCTYPE html>
<html lang="en">
  <head>
        <title>Manuel on Software - Reloaded - Generating unique static URLs in Odoo</title>
      <meta charset="utf-8" />
      <meta name="generator" content="Pelican" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0">




    <meta name="tags" content="Odoo" />

  </head>

  <body>
      <header>
          <hgroup><h1><a href="/">Manuel on Software - Reloaded</a></h1></hgroup>
          <nav><ul>
                <li><a href="/category/architecture.html" >architecture</a></li>
                <li><a href="/category/blogroll.html" >Blogroll</a></li>
                <li><a href="/category/book-reviews.html" >Book Reviews</a></li>
                <li><a href="/category/misc.html" >misc</a></li>
                <li><a href="/category/openerp.html" >OpenERP</a></li>
                <li><a href="/category/programming.html"  aria-current="page" >Programming</a></li>
                <li><a href="/category/python.html" >Python</a></li>
          </ul></nav>
      </header>
      <main>
  <article>
    <header>
      <h2>
        <a href="/2016/09/02/generating-unique-static-urls-in-odoo.html" rel="bookmark"
           title="Permalink to Generating unique static URLs in Odoo">Generating unique static URLs in Odoo</a></h2>
      
    </header>
    <p>By default Odoo bundles static assets (JS and CSS) within a couple of
files: All CSS files are bundled into a single big CSS file.  The same
happens for JS files.</p>
<p>The URLs of those bundles vary with any change within any of the
included files.  But those files are big.  Therefore changing assets
put some stress in the network and diminish the usefulness of caches.</p>
<p>Since Sep 19th, 2015 we introduced a <a class="reference external" href="https://github.com/merchise-autrement/odoo/commit/03741a2cb81907b4b67ca8437f260b073689d212">patch</a> in
Odoo to avoid bundling of static assets when using a SPDY or HTTP/2
proxy like Nginx.</p>
<p>Reportedly, this has worked very well in our case where some users
have slow connections.  However, measuring the logs of a week we see
that about 21% of GET request are assets:</p>
<pre class="literal-block">
$ egrep 'GET .*(\.|/)(css|js).* HTTP/' /var/log/nginx/o.access.log.1 | wc -l
10554

$ egrep 'GET .* HTTP' /var/log/nginx/o.access.log.1 | wc -l
50216
</pre>
<p>Odoo's default cache expiration time is seven days.  This is
considerably low taking into account that bundle's URLs change when
the content does.</p>
<p>Another issue is that assets that change can be served staled from the
caches for seven days.</p>
<p>We're taking the path to produce unique URLs for static assets.  Our
current work can be seen in our <a class="reference external" href="https://github.com/merchise-autrement/odoo/tree/merchise-unique-static-urls">merchise-unique-static-urls</a>
branch.  In our development/deployment scenarios these simple changes
would suffice for JS and CSS.  There's still work to do regarding
invalidation of static images in our templates.</p>

    <footer>
      <p>Published: <time datetime="2016-09-02T00:00:00+00:00">
        Fr 02 September 2016
      </time></p>
        <address>
          By             <a href="/author/manuel-vazquez-acosta.html">Manuel VÃ¡zquez Acosta</a>
        </address>
        <p>
          Category: <a href="/category/programming.html">Programming</a>
        </p>
        <p>
          Tags:
            <a href="/tag/odoo.html">Odoo</a>
        </p>
    </footer>
  </article>
      </main>
      <footer>
          <address>
            Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>,
            which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
          </address>
      </footer>
  </body>
</html>